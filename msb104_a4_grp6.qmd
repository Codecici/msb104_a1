---
title: "Assignment 4, MSB104-gruppe 6 2025"
author: Karin Liang
editor: visual
csl: apa7.csl
format:
  pdf: 
    documentclass: article
    number-sections: true
    keep-tex: true
    papersize: A4
  html:
    fig-cap-location: bottom
    fig-number: true
lang: NO_nb
bibliography: references4.bib
execute:
  warning: false
  message: false
  error: false
---

# 0. Kort sammendrag

# I. Innledning

## Bakgrunn

## Mål

## Betydning



# II. Litteraturgjennomgang

## Tidligere arbeid

Denne delen gir en oversikt over relevant litteratur fra oppgave 1–3 og danner et faglig grunnlag for å forstå sammenhenger mellom regional utvikling, utdanning, infrastruktur, demografi og inntektsulikhet.

@LESSMANN2017110 utnytter satellittdata for nattlys fra 180 land og 3166 regioner, og finner at om lag 67–70 % av landene viser sigma-konvergens, der inntektsforskjellene mellom regioner har blitt mindre over tid. Artikkelen avdekker også en N-formet sammenheng mellom økonomisk utvikling og regional ulikhet: ulikheten kan først øke, deretter avta, og igjen stige i høyinntektsfaser. Videre peker artikkelen på at utvikling, mobilitet, åpenhet, ressurser, institusjoner, overføringer og utdanning, og etnisitet utgjør syv grupper av faktorer som kan påvirke determinanter for regional ulikhet. Denne artikkelen gir et teoretisk grunnlag for disse oppgavene og viser at regional ulikhet påvirkes av flere strukturelle forhold samtidig.

I oppgave 1 benyttes @Cappelen2009 til å gi ytterligere forklaringer på hvordan regionale økonomiske forskjeller oppstår. @Cappelen2009 bruker ressursforvaltning og økonomisk utvikling i Norge, og viser at naturressurser, næringsstruktur og institusjonell utforming påvirker regioners økonomiske utviklingsmuligheter. Dette innebærer at ressursrike regioner kan ha en annen vekstbane enn andre regioner, noe som igjen påvirker regional utvikling. Videre gir @su13021006 en presis introduksjon til Gini-koeffisienten, og understreker at Gini er et av de mest brukte målene for økonomisk ulikhet, der verdien går fra 0 (full likhet) til 1 (full ulikhet). Dette gir et teoretisk grunnlag for å bruke Gini-koeffisienten som hovedindikator for regional inntektsulikhet i disse oppgavene.

I oppgave 2 brukes utdanning, infrastruktur og demografi som sentrale forklaringsvariabler for regional ulikhet. @Coady2017Income viser at utdanningsulikhet har en positiv sammenheng med inntektsulikhet, og at økte utdanningsmuligheter kan redusere forskjeller. Dermed vil regioner med høyere utdanningsnivå ofte ha lavere ulikhet. Når det gjelder infrastruktur, finner @Calderon2004Infrastructure at forbedringer i blant annet veitetthet bidrar til økonomisk vekst og reduserer regional ulikhet, og at veitetthet typisk har en negativ sammenheng med Gini. Innen demografi viser @dolls2019demographic at aldring kan øke ulikhet, ettersom en høyere andel eldre kan bidra til større inntektsforskjeller.

I oppgave 3 viser @kuznets2019economic utviklingen i forholdet mellom økonomisk vekst og inntektsfordeling, og argumenterer for at ulikhet kan følge et mønster der den først øker, deretter stabiliserer seg og til slutt faller, med vekt på at ulikhetsnivået kan endres med økonomiske strukturer og utviklingsstadier.

Samlet sett bidrar disse litteraturene, gjennom perspektiver på regionale økonomiske forskjeller, målemetoder for ulikhet og faktorer som utdanning, infrastruktur og demografi, til det teoretiske utgangspunktet for disse oppgavene. Litteraturen peker gjennomgående på at ulikhet påvirkes av flere strukturelle forhold, og at disse kan variere betydelig mellom regioner. De nevnte litteraturene danner et faglig grunnlag for å analysere forholdet mellom regional utvikling og inntektsulikhet.

## Forskningshull

Selv om eksisterende litteratur gir et viktig teoretisk grunnlag for å forstå forholdet mellom regional utvikling og inntektsulikhet, finnes det fortsatt områder som er lite utforsket. 

For det første, på datanivå, bygger tidligere arbeid som @LESSMANN2017110 hovedsakelig på nasjonale eller globale sammenligninger og analyserer sammenhengen mellom utvikling og ulikhet ved hjelp av tverrnasjonale datasett. Artikkelen benytter ikke Eurostat sine harmoniserte og direkte sammenlignbare NUTS2-regiondata innenfor samme statistiske rammeverk.

For det andre, fokuserer mange artikler ofte på en enkelt faktor, som utdanning, infrastruktur eller demografi, og analyserer sjelden disse variablene samtidig innenfor samme empiriske ramme. I disse oppgavene analyseres imidlertid utdanningsnivå (andel høyere utdanning), transportinfrastruktur (veitetthet), demografisk struktur (andel over 65 år) og økonomisk utvikling (BNP per innbygger eller endringen i BNP per innbygger) samlet i en modell i forhold til regional inntektsulikhet (Gini).

For det tredje, bruker tidligere arbeid en enkelt analysemodell, enten tverrsnittsanalyser eller  tidsseriestudier, og kombinerer sjelden flere tilnærminger som langtidsbeskrivelser, tverrsnittsregresjoner og paneldataanalyse. Dermed blir robuste tester av de samme sammenhengene på tvers av ulike metoder ofte fraværende.

Disse oppgavene benytter Eurostat-data og gjennomfører en sammenlignende analyse av Belgia, Bulgaria, Nederland og Norge. Gjennom langtidsbeskrivelsen av BNP per innbygger i oppgave 1, tverrsnittsanalysen i oppgave 2, og de alternative funksjonelle formene samt panelmodellene i oppgave 3, analyseres sammenhengene mellom regional økonomisk utvikling (BNP per innbygger eller endringen i BNP per innbygger), utdanning (andel høyere utdanning), transportinfrastruktur (veitetthet), demografisk struktur (andel over 65 år) og regional inntektsulikhet (Gini) fra flere perspektiver. På denne måten gir oppgavene en helhetlig tilnærming der de samme variablene undersøkes fra ulike metodiske vinkler, basert på én konsistent datakilde.

# III. Data og metodikk

## Datakilder

Datasettet som brukes i oppgave 1 kommer fra Eurostat og inkluderer "nama_10r_3gdp" (BNP) og "demo_r_pjanaggr3" (befolkning), begge tilgjengelig på NUTS3-nivå. Basert på BNP- og befolkningsdata for perioden 2000–2023 beregnes BNP per innbygger (BNPC), og flere NUTS3-regioner slås sammen til NUTS2 ved hjelp av befolkningsvekting. Innenfor samme sammenslåingsramme beregnes også Gini-koeffisienten på NUTS2-nivå for å måle regional inntektsulikhet. Siden Eurostat kun dekker Norge fra og med 2010, er tilgjengelige år for Norge kortere enn for de andre landene i disse oppgavene. I tillegg, selv uten å slette manglende verdier, varierer antall tilgjengelige observasjoner mellom land i de opprinnelige Eurostat-datasettene, og sammenslåing etter region fører også til tap av enkelte observasjoner. Noen NUTS2-regioner består kun av en NUTS3-enhet, noe som genererer flere NA-verdier ved beregning av Gini.

Oppgave 2 benytter 2017-data hentet fra datasett brukt i oppgave 1, og henter i tillegg nye datasett fra Eurostat: utdanning (andel høyere utdanning, ISCED 5–8) fra "edat_lfse_04", demografisk struktur (andel av befolkningen som er 65 år eller eldre) fra "demo_r_pjanaggr3", for transportinfrastruktur hentes veilengde fra "tran_r_net", og arealdata fra "reg_area3", som kombineres for å beregne veitetthet. Disse variablene utgjør 2017 tverrsnittsgrunnlaget for analysen av regional inntektsulikhet. Datasettene varierer i antall observasjoner mellom land, og enkelte regioner har manglende verdier, noe som fører til redusert utvalgsstørrelse etter datarensing.

Datasettet som brukes i oppgave 3 dekker perioden 2008–2022 og benytter de samme variablene som i oppgave 1 og oppgave 2, hentet fra de samme Eurostat-kildene. Det konstrueres analysefiler på tvers av år og modeller basert på samme datagrunnlag. Siden tilgjengelige år og datadekning varierer mellom land, får panelet en ubalansert struktur (unbalanced panel), og enkelte regioner mangler observasjoner i enkelte år. Dette reduserer antallet gyldige årsobservasjoner som kan inngå i estimeringen.

## Metodisk tilnærming

Oppgave 1 benytter en beskrivende metode (beskrivende analyse) ved å beregne og sammenligne BNP per innbygger (BNPC) og Gini-koeffisienten på NUTS2-nivå for perioden 2000–2023. Dette brukes for å observere og sammenligne regional utvikling og ulikhet i Belgia, Bulgaria, Nederland og Norge. Gjennom deskriptiv statistikk og visualisering, der blant annet figurene fordeling av Gini (NUTS2) etter land og Gini per NUTS2 over tid (fasettert etter land), synliggjøres ulikhetsfordelingen mellom regioner og utviklingen over tid på en tydelig måte. Den beskrivende analysen er hensiktsmessig som et første steg før modellering, ettersom den gir en oversikt over langsiktige mønstre i regional økonomisk utvikling og identifiserer sentrale forskjeller mellom regioner.

Oppgave 2 bygger på tverrsnittsdata for 2017 og estimerer både en enkel lineær regresjonsmodell og en multiple lineær regresjonsmodell. I den enkle lineære regresjonsmodellen testes hovedantakelsene i OLS, inkludert linearitet, uavhengighet, homoskedastisitet, fravær av multikollinearitet og normalfordeling av residualer. Deretter inkluderes nye forklaringsvariabler i den multiple modellen, blant annet høyere utdanning, veitetthet og andelen av befolkningen som er 65 år eller eldre. Tverrsnittstilnærmingen gjør det mulig å kontrollere flere faktorer på samme tidspunkt og sammenligne ulikhetsnivåer mellom regioner, noe som gir grunnlag for å analysere statistiske sammenhenger mellom forklaringsvariabler og regional inntektsulikhet.

Oppgave 3 benytter paneldata for perioden 2008–2022 og inkluderer delmengdeanalyse, alternative funksjonelle former som log-lineær modell, kvadratisk modell og kubisk modell, heteroskedastisitetstesting, samt panelestimering (region FE, year FE, two-way FE og country FE). De alternative funksjonelle formene brukes for å undersøke om forholdet mellom variabler er robust under ulike modellspecifikasjoner. Deretter estimeres faste effekter (FE) for å kontrollere for region-, år- eller lands-spesifikke egenskaper som ikke varierer over tid, slik at modellen utnytter variasjon på tvers av år for å estimere sammenhengen mellom økonomisk utvikling, høyere utdanning, veitetthet og andelen av befolkningen som er 65 år eller eldre og regional inntektsulikhet (Gini). Fordelen med panel-FE-modeller er at de reduserer skjevhet fra uobserverbare faktorer og dermed gir mer robuste estimater enn rene tverrsnittsmodeller.

# IV. Empiriske funn

## Resultater fra A2

```{r}
# pakker
library(readxl)
library(modelsummary)
library(dplyr)
library(plm)
```

### Enkel lineær regresjonsmodell

```{r}
# leser excel datasettet fra A2 for enkel lineær regresjonsmodell
data_2017_a <- read_excel("/Users/liang/Desktop/msb104/msb104_a4/data_2017_a.xlsx", sheet = "Sheet1")

# Enkel lineær regresjonsmodell
model_simple <- lm(Gini_weighted ~ change_GDPC_pct, data = data_2017_a)

# Sjekker dataene direkte
summary(model_simple)

```


### Multippel lineær regresjonsmodell

```{r}
# leser excel datasettet fra A2 for multippel lineær regresjonsmodell
data_2017_b <- read_excel("/Users/liang/Desktop/msb104/msb104_a4/data_2017_b.xlsx", sheet = "Sheet1")

# Estimerer en multippel lineær regresjonsmodell
model_multiple <- lm(
  Gini_weighted ~ change_GDPC_pct + utdanning_hoy + vei_tetthet + andelen_over65,
  data = data_2017_b)
summary(model_multiple)
```



## Resultater fra A3

### Alternative funksjonelle former

```{r}
# leser excel datasettet fra A3 for alternative funksjonelle former
data_2017 <- read_excel("/Users/liang/Desktop/msb104/msb104_a4/data_2017.xlsx", sheet = "Sheet1")

# Log-lineær modell
model_log <- lm(Gini_weighted ~ log(change_GDPC_pct + 1) + vei_tetthet + andelen_over65 + `Høy_utdanning`, data = data_2017)

# Kvadratisk modell
model_kvad <- lm(Gini_weighted ~ change_GDPC_pct + I(change_GDPC_pct^2) + vei_tetthet + andelen_over65 + `Høy_utdanning`, data = data_2017)

# Kubisk modell
model_kub <- lm(Gini_weighted ~ change_GDPC_pct + I(change_GDPC_pct^2) + I(change_GDPC_pct^3) + vei_tetthet + andelen_over65 + `Høy_utdanning`, data = data_2017)
```

```{r}
#| label: tbl-funksjonsformer
#| tbl-cap: "logaritmiske, kvadratiske, kubiske"
modelsummary(
  list(
    "Log-lineær modell" = model_log,
    "Kvadratisk modell" = model_kvad,
    "Kubisk modell"     = model_kub
  ),
  stars = TRUE,
  statistic = "({statistic})",   # viser t-verdier i parentes
  fmt = 5  
)
```



### Panelmodeller (Fire FE-spesifikasjoner)

```{r}
# leser excel datasettet fra A3 for alternative funksjonelle former
panel_df <- read_excel("/Users/liang/Desktop/msb104/msb104_a4/panel_df.xlsx", sheet = "Sheet1")

# Oppretter landkode fra NUTS2 og aggregerer data til land × år
panel_country <- panel_df %>%
  mutate(country = substr(NUTS2, 1, 2)) %>%
  group_by(country, TIME_PERIOD) %>%
  summarise(
    Gini_weighted   = mean(Gini_weighted,   na.rm = TRUE),
    change_GDPC_pct = mean(change_GDPC_pct, na.rm = TRUE),
    Høy_utdanning   = mean(Høy_utdanning,   na.rm = TRUE),
    andelen_over65  = mean(andelen_over65,  na.rm = TRUE),
    .groups = "drop"
  )

panel_country <- pdata.frame(panel_country, index = c("country", "TIME_PERIOD"))

# Modell 1: land-faste effekter
fe_country <- plm(
  Gini_weighted ~ change_GDPC_pct + Høy_utdanning + andelen_over65,
  data   = panel_country,
  model  = "within",
  effect = "individual"
)

# Konverterer datasettet til et panelobjekt med NUTS2 som enhets-ID og TIME_PERIOD som tidsvariabel
panel_df <- pdata.frame(panel_df, index = c("NUTS2", "TIME_PERIOD"))

# Modell 2: Faste effekter for år (year FE)
fe_year <- plm(
  Gini_weighted ~ change_GDPC_pct + `Høy_utdanning` + andelen_over65,
  data   = panel_df,   # pdata.frame med NUTS2 og år
  model  = "within",
  effect = "time"      # år som tids-FE
)

# Modell 3: Faste effekter på NUTS2-nivå (region FE)
fe_region <- plm(
  Gini_weighted ~ change_GDPC_pct + `Høy_utdanning` + andelen_over65,
  data   = panel_df,
  model  = "within",
  effect = "individual"    # individual = NUTS2-FE siden panelet er indeksert etter NUTS2
)

# Modell 4: Toveis faste effekter (NUTS2 + år)
fe_twoway <- plm(
  Gini_weighted ~ change_GDPC_pct + `Høy_utdanning` + andelen_over65,
  data   = panel_df,
  model  = "within",
  effect = "twoways"  # kontrollerer både for NUTS2- og årsfaste effekter
)
```

```{r}
#| label: tbl-panel
#| tbl-cap: "Sammenligning av panelmodeller"
modelsummary(
  list(
    "Region FE"   = fe_region,
    "Year FE"    = fe_year,
    "Two-way FE" = fe_twoway,
    "Country FE" = fe_country
  ),
  stars = TRUE, 
  fmt = 5 
)
```



# V. Diskusjon

## Viktige innsikter




## Politiske implikasjoner




# VI. Begrensninger og fremtidig forskning

## Forskningsbegrensninger

# VII. Konklusjon

## Sammendrag

## Sluttrefleksjon

# VIII. Referanser

# Vedlegg
